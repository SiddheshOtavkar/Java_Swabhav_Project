package com.solidPrinciples.miniproject;

import java.util.InputMismatchException;
import java.util.Scanner;

public class Main {
    public static void main(String[] args) {

        Scanner sc = new Scanner(System.in);

        try {
            /* 1️⃣  Product option (1 or 2) */
            System.out.println("Select product type:");
            System.out.println("  1) ELECTRONICS");
            System.out.println("  2) OTHER");
            System.out.print("Enter option (1 or 2): ");
            int productOpt = sc.nextInt();
            sc.nextLine();                        // clear newline

            if (productOpt != 1 && productOpt != 2) {
                System.out.println("Invalid product option. Exiting.");
                return;
            }
            String productType = (productOpt == 1) ? "ELECTRONICS" : "OTHER";

            /* 2️⃣  Amount (>0) */
            System.out.print("Enter order amount: ");
            double amount = sc.nextDouble();
            sc.nextLine();

            if (amount <= 0) {
                System.out.println("Amount must be greater than 0. Exiting.");
                return;
            }

            /* 3️⃣  Payment option (1 or 2) */
            System.out.println("Select payment method:");
            System.out.println("  1) CREDIT CARD");
            System.out.println("  2) PAYPAL");
            System.out.print("Enter option (1 or 2): ");
            int payOpt = sc.nextInt();
            sc.nextLine();

            IPaymentProcessor payment;
            if (payOpt == 1) {
                payment = new CreditCardProcessor();
            } else if (payOpt == 2) {
                payment = new PayPalProcessor();
            } else {
                System.out.println("Invalid payment option. Exiting.");
                return;
            }

            /* 4️⃣  Notification option (1 or 2) */
            System.out.println("Select notification method:");
            System.out.println("  1) EMAIL");
            System.out.println("  2) SMS");
            System.out.print("Enter option (1 or 2): ");
            int noteOpt = sc.nextInt();
            sc.nextLine();

            INotification notifier;
            if (noteOpt == 1) {
                notifier = new EmailNotification();
            } else if (noteOpt == 2) {
                notifier = new SMSNotification();
            } else {
                System.out.println("Invalid notification option. Exiting.");
                return;
            }

            /* 5️⃣  Discount (simple rule) */
            IDiscountStrategy discount =
                    productType.equals("ELECTRONICS") ? new ElectronicsDiscount()
                                                      : new NoDiscount();

            /* 6️⃣  Process the order */
            Order order = new Order(productType, amount);
            OrderProcessor processor = new OrderProcessor(discount, payment, notifier);
            processor.process(order);

        } catch (InputMismatchException ex) {
            System.out.println("Please enter numbers only where numbers are expected. Exiting.");
        } finally {
            sc.close();
        }
    }
}
